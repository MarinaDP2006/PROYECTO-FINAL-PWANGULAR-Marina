<div class="character-list-container">
  <header class="page-header">
    <h1>Personajes del Universo MOTU</h1>
    <p>Descubre los héroes y villanos más poderosos de Eternia</p>
  </header>

  <div class="filters-section">
    <div class="filter-group">
      <label for="search"> Buscar:</label>
      <input id="search" type="text" [value]="searchTerm()" (input)="onSearchChange($event)"
        placeholder="Buscar personajes..." class="filter-input">
    </div>

    <div class="filter-group">
      <label for="faction">Facción:</label>
      <select id="faction" [value]="selectedFaction()" (change)="onFactionChange($event)" class="filter-select">
        <option value="all">Todas</option>
        <option value="heroic">Heroica</option>
        <option value="evil">Malvada</option>
        <option value="independent">Independiente</option>
      </select>
    </div>

    <div class="filter-group">
      <label for="category">Categoría:</label>
      <select id="category" [value]="selectedCategory()" (change)="onCategoryChange($event)" class="filter-select">
        <option value="all">Todas</option>
        <option value="hero">Héroe</option>
        <option value="villain">Villano</option>
        <option value="neutral">Neutral</option>
      </select>
    </div>
  </div>

  <div class="results-info">
    <span class="results-count">{{ filteredCharacters().length }} personajes encontrados</span>
  </div>

  <div class="characters-grid">
    @for (character of filteredCharacters(); track character.id) {
    <div class="character-card">
      <div class="card-header">
        <div class="character-image">
          <img [src]="character.imageUrl" [alt]="character.name"(error)="$event.target.src = '/assets/images/placeholder-character.png'">
        </div>
        <div class="character-badges">
          <span class="badge faction-badge" [attr.data-faction]="character.faction">
            {{ getFactionIcon(character.faction) }}
          </span>
          <span class="badge category-badge" [attr.data-category]="character.category">
            {{ getCategoryIcon(character.category) }}
          </span>
          <span class="badge power-badge" [attr.data-power]="character.powerType">
            {{ getPowerTypeIcon(character.powerType) }}
          </span>
        </div>
      </div>

      <div class="card-content">
        <h3 class="character-name">{{ character.name }}</h3>

        @if (character.realName) {
        <p class="real-name">{{ character.realName }}</p>
        }

        <p class="character-description">{{ character.description }}</p>

        <div class="character-details">
          @if (character.origin) {
          <div class="detail-item">
            <strong>Origen:</strong> {{ character.origin }}
          </div>
          }

          @if (character.affiliation) {
          <div class="detail-item">
            <strong>Afiliación:</strong> {{ character.affiliation }}
          </div>
          }

          @if (character.abilities && character.abilities.length > 0) {
          <div class="detail-item">
            <strong>Habilidades:</strong>
            <div class="abilities-list">
              @for (ability of character.abilities; track ability) {
              <span class="ability-tag">{{ ability }}</span>
              }
            </div>
          </div>
          }

          @if (character.weapons && character.weapons.length > 0) {
          <div class="detail-item">
            <strong>Armas:</strong>
            <div class="weapons-list">
              @for (weapon of character.weapons; track weapon) {
              <span class="weapon-tag">{{ weapon }}</span>
              }
            </div>
          </div>
          }
        </div>
      </div>

      <div class="card-actions">
        <button [routerLink]="['/characters', character.id]" class="btn btn-primary">
          Ver Detalles
        </button>
        <button [routerLink]="['/edit', character.id]" class="btn btn-secondary">Editar
        </button>
        <button (click)="deleteCharacter(character.id)" class="btn btn-danger">
          Eliminar
        </button>
      </div>
    </div>
    } @empty {
    <div class="empty-state">
      <h3>No se encontraron personajes</h3>
      <p>Intenta ajustar tus filtros de búsqueda</p>
      <button routerLink="/add" class="btn btn-primary">
        Agregar Nuevo Personaje
      </button>
    </div>
    }
  </div>
</div>